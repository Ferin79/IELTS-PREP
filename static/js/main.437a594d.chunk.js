(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t,a){e.exports=a(200)},150:function(e,t){},165:function(e,t){},167:function(e,t){},193:function(e,t,a){e.exports=a.p+"static/media/skype_remix_2.5ab01274.mp3"},199:function(e,t,a){},200:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(22),l=a.n(c),o=a(31),s=a(9),i=a(58),u=a.n(i);u.a.initializeApp({apiKey:"AIzaSyAeGlC39mCJhsStuaGT5rRYKNthOLU2Myg",authDomain:"ielts-preps.firebaseapp.com",databaseURL:"https://ielts-preps.firebaseio.com",projectId:"ielts-preps",storageBucket:"ielts-preps.appspot.com",messagingSenderId:"1048340373708",appId:"1:1048340373708:web:aeaeb3f53d5fcc67256269",measurementId:"G-KRE50H8H0Z"});var m=u.a,d=Object(n.createContext)(),f=function(e){var t=e.children,a=Object(n.useState)(null),c=Object(s.a)(a,2),l=c[0],o=c[1],i=Object(n.useState)(!1),u=Object(s.a)(i,2),f=u[0],E=u[1];return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userInfo"));e&&e.role&&e.institute_id?("admin"!==e.role&&"staff"!==e.role||E(!0),m.auth().onAuthStateChanged((function(e){o(e||null)}))):m.auth().signOut()}),[]),r.a.createElement(d.Provider,{value:{currentUser:l,setCurrentUser:o,isProfessor:f,setIsProfessor:E}},t)},E=a(7),g=a(88),p=a(89),b=a(43),v=a(25),O=a(91),h=a(90),j=function(){var e=Object(n.useContext)(d).setIsProfessor,t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)(!1),i=Object(s.a)(o,2),u=i[0],f=i[1],E=Object(n.useState)(""),j=Object(s.a)(E,2),y=j[0],C=j[1];return r.a.createElement(g.a,null,r.a.createElement(p.a,{className:"d-flex justify-content-center align-items-center m-5"},r.a.createElement(b.a,{xl:"6",lg:!0},r.a.createElement(v.a,{onSubmit:function(t){l(""),f(!0),t.preventDefault();var a=t.target.email.value,n=t.target.password.value;""!==a.trim()?""!==n.trim()?m.auth().signInWithEmailAndPassword(a,n).then((function(t){m.firestore().doc("/users/".concat(t.user.email)).get().then((function(t){t.data().isAdmin||t.data().isStaff?e(!0):e(!1);var a="";t.data().isStudent&&(a="student"),t.data().isAdmin&&(a="admin"),t.data().isStaff&&(a="staff"),localStorage.setItem("userInfo",JSON.stringify({role:a,institute_id:t.data().institute_id}))})).catch((function(e){return console.log(e)}))})).catch((function(e){l(e.message)})).finally((function(){f(!1)})):l("Password Cannot be Empty"):l("Email Cannot be Empty")}},r.a.createElement(v.a.Group,{controlId:"email"},r.a.createElement(v.a.Label,null,"Email address"),r.a.createElement(v.a.Control,{type:"email",placeholder:"Enter email",value:y,onChange:function(e){return C(e.target.value)}})),r.a.createElement(v.a.Group,{controlId:"password"},r.a.createElement(v.a.Label,null,"Password"),r.a.createElement(v.a.Control,{type:"password",placeholder:"Password"})),c&&r.a.createElement("p",{className:"text-danger"},"* ",c),u?r.a.createElement(h.a,{animation:"border",variant:"primary"}):r.a.createElement(O.a,{variant:"primary",type:"submit"},"Login")),r.a.createElement("p",{className:"addHover mt-3",onClick:function(){""!==y.trim()?m.auth().sendPasswordResetEmail(y).then((function(){return alert("Password reset Link send successfully.")})).catch((function(e){return alert(e.message)})):l("Enter email to send password reset link.")}},"Forgot Password ?"))))},y=a(92),C=a(93),k=a.n(C),S=a(59),T=a.n(S),N=a(95),w=a(210),I=a(36),L=a(205),x=a(206),P=a(207),A=a(208),U=a(209),D=a(94),R=a.n(D);function z(){var e=Object(y.a)(["\n  display: flex;\n  width: 100%;\n"]);return z=function(){return e},e}var M=new Audio(a(193));M.loop=!0;var B=function(){return r.a.createElement(R.a,{type:"TailSpin",color:"#00BFFF"})},V=N.a.div(z());var F=function(){var e=Object(n.useRef)(null),t=Object(n.useState)(""),a=Object(s.a)(t,2),c=a[0],l=a[1],o=Object(n.useState)({}),i=Object(s.a)(o,2),u=i[0],m=i[1],d=Object(n.useState)(),f=Object(s.a)(d,2),E=f[0],p=f[1],h=Object(n.useState)(!1),j=Object(s.a)(h,2),y=j[0],C=j[1],S=Object(n.useState)(""),N=Object(s.a)(S,2),D=N[0],R=N[1],z=Object(n.useState)(),F=Object(s.a)(z,2),G=F[0],J=F[1],_=Object(n.useState)(!1),H=Object(s.a)(_,2),K=H[0],W=H[1],Y=Object(n.useState)(!1),Z=Object(s.a)(Y,2),q=Z[0],Q=Z[1],X=Object(n.useState)(!1),$=Object(s.a)(X,2),ee=$[0],te=$[1],ae=Object(n.useState)(""),ne=Object(s.a)(ae,2),re=ne[0],ce=ne[1],le=Object(n.useRef)(),oe=Object(n.useRef)(),se=Object(n.useRef)(),ie=Object(n.useState)(!0),ue=Object(s.a)(ie,2),me=ue[0],de=ue[1],fe=Object(n.useState)(!0),Ee=Object(s.a)(fe,2),ge=Ee[0],pe=Ee[1],be=Object(n.useState)("user"),ve=Object(s.a)(be,2),Oe=ve[0],he=ve[1];Object(n.useEffect)((function(){se.current=k.a.connect("http://localhost:8000/"),navigator.mediaDevices.getUserMedia({video:{facingMode:Oe},audio:!0}).then((function(e){p(e),le.current&&(le.current.srcObject=e)})).catch((function(e){I.b.error("Provide Permission")})),se.current.on("yourID",(function(e){l(e)})),se.current.on("allUsers",(function(e){console.log(e),m(e)})),se.current.on("receiveCall",(function(e){console.log("Reciving"),C(!0),R(e.from.name),ce(e.from.id),J(e.signal)})),se.current.on("changeNameStatus",(function(e){e.status||I.b.error("name already taken!")}))}),[Oe]);var je,ye,Ce,ke,Se,Te=function(e){Q(!0),setTimeout((function(){Q(!1)}),e)},Ne=r.a.createElement(v.a,{onSubmit:function(e){e.preventDefault();var t=e.target.name.value,a=!1;Object.keys(u).forEach((function(e){e!==c&&t===u[e]&&(a=!0)})),a?I.b.error("name already taken!"):se.current.emit("changeName",{name:t})}},r.a.createElement(v.a.Group,{controlId:"name"},r.a.createElement(v.a.Label,null,"Change Display name"),r.a.createElement(v.a.Control,{type:"text",placeholder:"Enter name"})),r.a.createElement(O.a,{variant:"primary",type:"submit",size:"sm"},r.a.createElement("small",null,"Change Name")));E&&(je=r.a.createElement("video",{className:"userVideo",playsInline:!0,muted:!0,ref:le,autoPlay:!0}),"professor"===u[c]&&(ye=Object.keys(u).map((function(t){return t===c?null:r.a.createElement(O.a,{variant:"primary",onClick:function(){return a=t,e.current=new T.a({initiator:!0,trickle:!1,stream:E}),console.log("Call user"),e.current.on("signal",(function(e){se.current.emit("callUser",{userToCall:a,signalData:e,from:c})})),e.current.on("stream",(function(e){oe.current&&(oe.current.srcObject=e)})),se.current.on("callAccepted",(function(t){W(!0),ce(a),e.current.signal(t),te(!0),console.log("accepted")})),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),ce(""),W(!1),te(!1),se.current.removeListener("callAccepted"),se.current.removeListener("videoStatusChange"),se.current.removeListener("audioStatusChange")})),se.current.on("callEnded",(function(){e.current.destroy("Call ended")})),void se.current.on("error",(function(t){e.current.destroy(t.message)}));var a},disabled:ee,style:{margin:5}},"Call ",u[t])})))),K&&(Ce=r.a.createElement("video",{className:"partnerVideo",playsInline:!0,ref:oe,autoPlay:!0}),ke=r.a.createElement("div",{className:"endCallButton"},r.a.createElement(O.a,{variant:"danger",onClick:function(){se.current.emit("endCall",{id:re})}},"End Call")));var we,Ie,Le=me?"success":"danger",xe=ge?"success":"danger",Pe=me?r.a.createElement(L.a,{size:20}):r.a.createElement(x.a,{size:20}),Ae=ge?r.a.createElement(P.a,{size:20}):r.a.createElement(A.a,{size:20});return Se=r.a.createElement(V,{className:"justify-content-md-center"},r.a.createElement(O.a,{variant:Le,onClick:function(){Te(400);var t=E.getVideoTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({video:{facingMode:Oe}}).then((function(a){var n=a.getVideoTracks()[0];E.removeTrack(t),E.addTrack(n),de(!0),K&&e.current.replaceTrack(t,n,E)})):"live"===t.readyState&&(t.stop(),de(!1),K&&e.current.replaceTrack(t,t,E))},style:{margin:5}}," ",Pe," "),r.a.createElement(O.a,{variant:xe,onClick:function(){Te(400);var t=E.getAudioTracks()[0];"ended"===t.readyState?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(a){var n=a.getAudioTracks()[0];E.removeTrack(t),E.addTrack(n),pe(!0),K&&e.current.replaceTrack(t,n,E)})):"live"===t.readyState&&(t.stop(),pe(!1),K&&e.current.replaceTrack(t,t,E))},style:{margin:5}}," ",Ae," "),me&&r.a.createElement(O.a,{onClick:function(){Te(1700);var t="user"===Oe?"environment":"user",a=E.getVideoTracks()[0];a.stop(),navigator.mediaDevices.getUserMedia({video:{facingMode:Oe}}).then((function(t){var n=t.getVideoTracks()[0];E.removeTrack(a),E.addTrack(n),de(!0),K&&e.current.replaceTrack(a,n,E)})),he(t)},style:{margin:5}}," ",r.a.createElement(U.a,null)," ")),"professor"!==u[c]&&Object.keys(u).forEach((function(e){e!==c&&"professor"===u[e]&&(we="Professor online")})),y&&u[re]?(M.play(),Ie=r.a.createElement("div",{className:"incommingCall"},r.a.createElement(w.a,{className:"text-center",style:{background:"black",color:"white"}},r.a.createElement(w.a.Header,null,r.a.createElement("h2",null,D," is calling you")),r.a.createElement(w.a.Body,null,r.a.createElement(w.a.Title,null),r.a.createElement(g.a,null,r.a.createElement(V,null,r.a.createElement(b.a,null,r.a.createElement(O.a,{size:"lg",variant:"danger",onClick:function(){}},"Reject")),r.a.createElement(b.a,null,r.a.createElement(O.a,{size:"lg",variant:"success",onClick:function(){M.pause(),M.currentTime=0,W(!0),C(!1),te(!0),e.current=new T.a({initiator:!1,trickle:!1,stream:E}),e.current.on("signal",(function(e){se.current.emit("acceptCall",{signal:e,to:re})})),e.current.on("stream",(function(e){oe.current.srcObject=e})),e.current.signal(G),e.current.on("error",(function(e){console.log(e),"Call ended"!==e&&alert("Connection error or client closed webpage!"),W(!1),R(""),ce(""),J(),te(!1),se.current.removeListener("videoStatusChange"),se.current.removeListener("audioStatusChange")})),se.current.on("callEnded",(function(){e.current.destroy("Call ended")}))}},"Accept"))))),r.a.createElement(w.a.Footer,{className:"text-muted"})))):(M.pause(),M.currentTime=0),r.a.createElement(r.a.Fragment,null,Ie,Ce,r.a.createElement("div",{className:"userElements"},je,Se),r.a.createElement("div",{className:"userElementsLoadingBox",hidden:!q},r.a.createElement("div",{className:"userElementsLoading"},r.a.createElement(B,null))),ke,r.a.createElement(g.a,{style:{color:"white"},fluid:!0},r.a.createElement(V,null,ye),r.a.createElement(V,null,r.a.createElement(b.a,null,r.a.createElement("h4",null,"You: ",u[c]),Ne,r.a.createElement(V,{style:{color:"green",fontWeight:"bold"}},we))),r.a.createElement(I.a,{autoClose:2e3})))},G=function(){return Object(n.useContext)(d).currentUser?r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/",exact:!0,component:F}),r.a.createElement(E.a,{to:"/"})):r.a.createElement(E.d,null,r.a.createElement(E.b,{path:"/login",component:j}),r.a.createElement(E.a,{to:"/login"}))},J=(a(196),a(37)),_=a(38),H=function(){var e=Object(n.useContext)(d).currentUser;return r.a.createElement(J.a,{bg:"dark",expand:"lg",variant:"dark"},r.a.createElement(J.a.Brand,{href:"/"},"IELTS Video"),r.a.createElement(J.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(J.a.Collapse,{id:"basic-navbar-nav center"},r.a.createElement(_.a,{className:"mx-auto"},r.a.createElement(_.a.Link,{as:o.b,to:"/contact",className:"changeNavColor"},"Contact Us"),r.a.createElement(_.a.Link,{as:o.b,to:"/privacy",className:"changeNavColor"},"Privacy Policy"),e&&r.a.createElement(_.a.Link,null,r.a.createElement("button",{id:"logoutBtn",style:{background:"transparent",border:"none",color:"white"},onClick:function(){return m.auth().signOut()},href:"#/"},"Logout")))))},K=function(){return r.a.createElement(f,null,r.a.createElement(o.a,null,r.a.createElement(H,null),r.a.createElement(G,null)))};a(197),a(198),a(199);l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(K,null)),document.getElementById("root"))}},[[104,1,2]]]);
//# sourceMappingURL=main.437a594d.chunk.js.map